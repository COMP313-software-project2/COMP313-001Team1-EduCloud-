{"ast":null,"code":"import { OrderedMap } from 'immutable';\nimport _ from 'lodash';\nconst users = OrderedMap({\n  '1': {\n    _id: '1',\n    name: \"Julia Ly\",\n    created: new Date(),\n    avatar: 'https://api.adorable.io/avatars/100/abott@julia.png'\n  },\n  '2': {\n    _id: '2',\n    name: \"Gavin Ray\",\n    created: new Date(),\n    avatar: 'https://api.adorable.io/avatars/100/abott@gavin.png'\n  },\n  '3': {\n    _id: '3',\n    name: \"Darren Simpsons\",\n    created: new Date(),\n    avatar: 'https://api.adorable.io/avatars/100/abott@darren.png'\n  }\n});\nexport default class Store {\n  constructor(appComponent) {\n    this.app = appComponent;\n    this.messages = new OrderedMap();\n    this.channels = new OrderedMap();\n    this.activeChannelId = null;\n    this.user = {\n      _id: 0,\n      name: \"Julia\",\n      created: new Date()\n    };\n  }\n\n  addUserToChannel(channelId, userId) {\n    const channel = this.channels.get(channelId);\n\n    if (channel) {\n      // now add this member id to channels members.\n      channel.members = channel.members.set(userId, true);\n      this.channels = this.channels.set(channelId, channel);\n      this.update();\n    }\n  }\n\n  searchUsers(search = \"\") {\n    let searchItems = new OrderedMap();\n\n    if (_.trim(search).length) {\n      //do search in our users list\n      users.filter(user => {\n        const name = _.get(user, 'name');\n\n        const userId = _.get(user, '_id');\n\n        if (_.includes(name, search)) {\n          searchItems = searchItems.set(userId, user);\n        }\n      });\n    }\n\n    return searchItems.valueSeq();\n  }\n\n  onCreateNewChannel(channel = {}) {\n    const channelId = _.get(channel, '_id');\n\n    this.addChannel(channelId, channel);\n    this.setActiveChannelId(channelId); //console.log(JSON.stringify(this.channels.toJS()));\n  }\n\n  getCurrentUser() {\n    return this.user;\n  }\n\n  setActiveChannelId(id) {\n    this.activeChannelId = id;\n    this.update();\n  }\n\n  getActiveChannel() {\n    const channel = this.activeChannelId ? this.channels.get(this.activeChannelId) : this.channels.first();\n    return channel;\n  }\n\n  addMessage(id, message = {}) {\n    this.messages = this.messages.set(`${id}`, message); //let;s add new message id to current channel --> messages\n\n    const channelId = _.get(message, 'channelId');\n\n    if (channelId) {\n      let channel = this.channels.get(channelId);\n      channel.isNew = false;\n      channel.lastMessage = _.get(message, 'body', '');\n      channel.messages = channel.messages.set(id, true);\n      this.channels = this.channels.set(channelId, channel);\n    }\n\n    this.update();\n  }\n\n  getMessages() {\n    return this.messages.valueSeq();\n  }\n\n  getMessagesFromChannel(channel) {\n    let messages = [];\n\n    if (channel) {\n      channel.messages.map((value, key) => {\n        // console.log(\"hi--0-\", value, key);\n        // console.log(typeof key);\n        const message = this.messages.get(key); // console.log(\"debyg\", message);\n\n        messages.push(message);\n      });\n    }\n\n    return messages;\n  }\n\n  getMembersFromChannel(channel) {\n    let members = new OrderedMap();\n\n    if (channel) {\n      channel.members.map((value, key) => {\n        console.log(key, value);\n        const user = users.get(key);\n        console.log(\"user is\", user);\n        members = members.set(key, user);\n      });\n    }\n\n    return members.valueSeq();\n  }\n\n  addChannel(index, channel = {}) {\n    this.channels = this.channels.set(`${index}`, channel);\n    this.update();\n  }\n\n  getChannels() {\n    // return this.channels.valueSeq();\n    // we need to sort channel by date , the last one will list on top.\n    this.channels = this.channels.sort((a, b) => a.created < b.created);\n    return this.channels.valueSeq();\n  }\n\n  update() {\n    this.app.forceUpdate();\n  }\n\n}","map":{"version":3,"sources":["/Users/youngshinmin/Desktop/software-project/app/src/store.js"],"names":["OrderedMap","_","users","_id","name","created","Date","avatar","Store","constructor","appComponent","app","messages","channels","activeChannelId","user","addUserToChannel","channelId","userId","channel","get","members","set","update","searchUsers","search","searchItems","trim","length","filter","includes","valueSeq","onCreateNewChannel","addChannel","setActiveChannelId","getCurrentUser","id","getActiveChannel","first","addMessage","message","isNew","lastMessage","getMessages","getMessagesFromChannel","map","value","key","push","getMembersFromChannel","console","log","index","getChannels","sort","a","b","forceUpdate"],"mappings":"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","sourcesContent":["import {OrderedMap} from 'immutable'\nimport _ from 'lodash'\n\nconst users = OrderedMap({\n    '1': {_id: '1', name:\"Julia Ly\", created: new Date(),avatar:'https://api.adorable.io/avatars/100/abott@julia.png'},\n    '2': {_id: '2', name:\"Gavin Ray\", created: new Date(), avatar:'https://api.adorable.io/avatars/100/abott@gavin.png'},\n    '3': {_id: '3', name:\"Darren Simpsons\", created: new Date(), avatar:'https://api.adorable.io/avatars/100/abott@darren.png'},\n})\n\nexport default class Store {\n    constructor(appComponent) {\n\n        this.app=appComponent;\n        this.messages = new OrderedMap();\n        this.channels = new OrderedMap();\n        this.activeChannelId = null;\n        this.user = {\n            _id: 0,\n            name: \"Julia\",\n            created: new Date(),\n        }\n    }\n\n    addUserToChannel(channelId, userId) {\n\n        \n        const channel = this.channels.get(channelId);\n    \n        if (channel) {\n    \n            // now add this member id to channels members.\n            channel.members = channel.members.set(userId, true);\n            this.channels = this.channels.set(channelId, channel);\n            this.update();\n            }\n    \n        }\n    \n\n\n    searchUsers(search = \"\"){\n\n        let searchItems = new OrderedMap(); \n\n        if(_.trim(search).length) {\n            //do search in our users list\n            users.filter((user) => {\n\n                const name = _.get(user,'name');\n                const userId = _.get(user, '_id');  \n\n                if(_.includes(name, search)){\n                    \n                    searchItems = searchItems.set(userId, user);\n                }    \n\n            })\n        }\n        return searchItems.valueSeq();\n\n    }\n\n    onCreateNewChannel(channel = {}) {\n\n        const channelId = _.get(channel, '_id');\n        this.addChannel(channelId, channel);\n        this.setActiveChannelId(channelId);\n\n        //console.log(JSON.stringify(this.channels.toJS()));\n\n    }\n\n\n    getCurrentUser(){\n\n        return this.user;\n\n    }\n\n\n    setActiveChannelId(id){\n        this.activeChannelId=id;\n        this.update();\n    }\n\n\n    getActiveChannel(){\n        const channel = this.activeChannelId ? this.channels.get(this.activeChannelId) : this.channels.first();  \n        return channel;    \n    }\n\n    addMessage(id, message = {}){\n        this.messages = this.messages.set(`${id}`, message);\n        //let;s add new message id to current channel --> messages\n        const channelId = _.get(message,'channelId');\n        if(channelId){\n            let channel = this.channels.get(channelId);\n\n            channel.isNew = false;\n            channel.lastMessage = _.get(message, 'body', '');\n            channel.messages = channel.messages.set(id, true);\n            this.channels = this.channels.set(channelId, channel);\n\n        }\n        this.update();\n    }\n    getMessages() {\n\n        return this.messages.valueSeq();\n    }\n\n    getMessagesFromChannel(channel) {\n        \n        let messages = [];\n\n        if(channel){\n            channel.messages.map((value, key) => {\n\n            // console.log(\"hi--0-\", value, key);\n            // console.log(typeof key);\n            const message =this.messages.get(key);\n            // console.log(\"debyg\", message);\n            messages.push(message);\n            });\n        }\n        return messages;\n    }\n\n    getMembersFromChannel(channel){\n\n    let members = new OrderedMap();\n\n    if(channel) {\n        channel.members.map((value, key) => {\n        console.log(key, value);\n\n            const user = users.get(key);\n            console.log(\"user is\", user);\n            members = members.set(key, user);\n        });\n    }\n    return members.valueSeq();\n}\n\n    addChannel(index, channel = {}) {\n        this.channels = this.channels.set(`${index}`, channel);\n        this.update();\n    }\n   getChannels(){\n    // return this.channels.valueSeq();\n    // we need to sort channel by date , the last one will list on top.\n    this.channels = this.channels.sort((a, b) => a.created < b.created);\n\n    return this.channels.valueSeq();\n   }\n\n   update() {\n       this.app.forceUpdate();\n   }\n}"]},"metadata":{},"sourceType":"module"}